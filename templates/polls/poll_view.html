{% extends "polls/base.html" %}

{% block contextNav %}
    <li><a href="{% url 'polls.views.new_poll' %}">Create New Poll</a></li>
    <li><a href="{% url 'polls.views.all_polls' %}">View All Polls</a></li>
{% endblock%}

{% block pageTitle %}
{{poll.name}}
{% endblock %}

{% block baseContent %}
<p>{{poll.context}}</p><br/>
<p>End Date: {{poll.end_date}}</p><br/>
<p>Votes Allowed Per Person: {{poll.max_votes}}</p><br/>
<form action="{% url 'polls.views.vote' poll.id %}" id="poll" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <table>
    <tr>
        <td></td>
        <td><b>Item</b></td>
        <td><b>Votes</b></td>
        <td></td>
        <td></td>
    </tr>
    {% for item in items %}
    <tr>        
            <td>
                {% if sup %}
                    <input type="checkbox" id="item" name="{{item.id}}" value="Submit" >   
                {% else %}
                {% endif %}
            </td>
            <td>{{item.item}}</td>
            <td>{{item.votes}}</td>
            <td><input type='hidden' name='item' id='id_item' value='{{item.id}}'/></td>
            
            <td><meter style="width:200px;height:25px;" id="items" title="Poll Results" max="{{most_votes}}" low="1" high="8" optimum="5" value="{{item.votes}}">Value can be here too< meter></td>    
    </tr>
    {% endfor %}
</table>
{% if sup %}
<input type="submit" name="submit" value="Submit"/>
{% endif %}

</form>



{% if user == poll.creator %}
<form action="{% url 'polls.views.end_poll' poll.id %}" id = "pollForm" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <input type="submit" name="end_poll" value="End Poll"/>
</form>
{% endif %}

{% endblock %}

{% block endScripts %}
<script type="text/javascript">
$("form").on("click", ":checkbox", function(event){
  $(":checkbox:not(:checked)", this.form).prop("disabled", function(){
    return $(this.form).find(":checkbox:checked").length == {{poll.max_votes}};
  });
});
</script>
{% endblock %}