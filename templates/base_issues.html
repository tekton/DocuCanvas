<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Test Page of Testing</title>
        <style>
            ::-moz-selection {
                background: #b3d4fc;
                text-shadow: none;
            }

            ::selection {
                background: #b3d4fc;
                text-shadow: none;
            }

            html {
                padding: 30px 10px;
                font-size: 20px;
                line-height: 1.4;
                color: #737373;
                background: #f0f0f0;
                -webkit-text-size-adjust: 100%;
                -ms-text-size-adjust: 100%;
            }

            html,
            input {
                font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
            }

            body {
                max-width: 80%;
                _width: 80%;
                padding: 30px 20px 50px;
                border: 1px solid #b3b3b3;
                border-radius: 4px;
                margin: 0 auto;
                box-shadow: 0 1px 10px #a7a7a7, inset 0 1px 0 #fff;
                background: #fcfcfc;
            }

            h1 {
                margin: 0 10px;
                font-size: 50px;
                text-align: center;
            }

            h1 span {
                color: #bbb;
            }

            h3 {
                margin: 1.5em 0 0.5em;
            }

            p {
                margin: 1em 0;
            }

            ul {
                padding: 0 0 0 40px;
                margin: 1em 0;
            }

            a{
                text-decoration:none;
                color:#737373;
            }

            .container {
                /*max-width: 1000px;*/
                _width: 380px;
                margin: 0 0 30px auto;
                margin-right: 275px;
                padding: 30px 20px 50px;
                border: 1px solid white;
                border-radius: 4px;
                box-shadow: 0 1px 10px #a7a7a7, inset 0 1px 0 #fff;
                background: #fcfcfc;
            }

            .container_nav{
                /*max-width: 1000px;*/
                _width: 380px;
                margin: 0 auto;
                margin-right: 225px;
                padding: 30px 20px 50px;
                border: 1px solid white;
                border-radius: 4px;
                box-shadow: 0 1px 10px #a7a7a7, inset 0 1px 0 #fff;
                background: #fcfcfc;
            }

            .container_nav a{
                display:inline-block;
                width:100%;
                border-radius: 4px;
            }

            .container_nav a:hover{
                cursor:pointer;
                background:#bbb;
            }

            .spiffy_box {
                max-width: 250px;
                _width: 250px;
                margin: 0 auto;

                padding: 30px 20px 50px;
                border: 1px solid white;
                border-radius: 4px;
                box-shadow: 0 1px 10px #a7a7a7, inset 0 1px 0 #fff;
                background: #fcfcfc;

                font-size: .8em;           
            }

            .left {
                float: left;
            }
            
            .right {
                float: right;
            }
            
            .right-avoid {
                
            }
            
            .both {
                clear: both;
            }

            .main_nav_button{
                display:inline;
            }

            .main_nav_button:hover{
                cursor:pointer;
            }

            #context_nav {
                width: 20em;
                padding: 1em;
                position: absolute;
                top: 6.5em;
                right: 15.5em;
                min-height: 2em;
                height:auto;
                overflow: hidden;
                z-index:10;
                font-size:0.7em;
                display:none;
            }

            #projects_nav {
                width: 20em;
                padding: 1em;
                position: absolute;
                top: 6.5em;
                right: 2.5em;
                min-height: 2em;
                height:auto;
                overflow: hidden;
                z-index:10;
                font-size:0.7em;
                display:none;
            }


            #account_nav {
                width: 135px;
                padding: 1em;
                position: absolute;
                top: 6.5em;
                right: 6.5em;
                height: 2em;
                overflow: hidden;
                z-index:10;
                font-size:0.7em;
                display:none;
            }
            #search_nav {
                width: 10em;
                padding: 1em;
                position: absolute;
                top: 6.5em;
                right:0;
                height: 2em;
                overflow: hidden;
                z-index:10;
                font-size:0.7em;
                display:none;
            }

            /* google search */

            #goog-fixurl ul {
                list-style: none;
                padding: 0;
                margin: 0;
            }

            #goog-fixurl form {
                margin: 0;
            }

            #goog-wm-qt,
            #goog-wm-sb {
                border: 1px solid #bbb;
                font-size: 16px;
                line-height: normal;
                vertical-align: top;
                color: #444;
                border-radius: 2px;
            }

            #goog-wm-qt {
                width: 220px;
                height: 20px;
                padding: 5px;
                margin: 5px 10px 0 0;
                box-shadow: inset 0 1px 1px #ccc;
            }

            #goog-wm-sb {
                display: inline-block;
                height: 32px;
                padding: 0 10px;
                margin: 5px 0 0;
                white-space: nowrap;
                cursor: pointer;
                background-color: #f5f5f5;
                background-image: -webkit-linear-gradient(rgba(255,255,255,0), #f1f1f1);
                background-image: -moz-linear-gradient(rgba(255,255,255,0), #f1f1f1);
                background-image: -ms-linear-gradient(rgba(255,255,255,0), #f1f1f1);
                background-image: -o-linear-gradient(rgba(255,255,255,0), #f1f1f1);
                -webkit-appearance: none;
                -moz-appearance: none;
                appearance: none;
                *overflow: visible;
                *display: inline;
                *zoom: 1;
            }

            #goog-wm-sb:hover,
            #goog-wm-sb:focus {
                border-color: #aaa;
                box-shadow: 0 1px 1px rgba(0, 0, 0, 0.1);
                background-color: #f8f8f8;
            }

            #goog-wm-qt:hover,
            #goog-wm-qt:focus {
                border-color: #105cb6;
                outline: 0;
                color: #222;
            }

            input::-moz-focus-inner {
                padding: 0;
                border: 0;
            }
        /* titles and stuff */
        .title {
            
        }
        
        .sub-title {
            
        }

        {% block style %}{% endblock %}
        </style>

        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script><!-- shoudl be changed to local source?-->
        <script>window.jQuery || document.write('<script src="/static/js/vendor/jquery-1.8.0.min.js"><\/script>')</script>

        <script type="text/javascript">
            var csrftoken;

            function getCookie(name) {
                var cookieValue = null;
                if (document.cookie && document.cookie != '') {
                    var cookies = document.cookie.split(';');
                    for (var i = 0; i < cookies.length; i++) {
                        var cookie = jQuery.trim(cookies[i]);
                        // Does this cookie string begin with the name we want?
                        if (cookie.substring(0, name.length + 1) == (name + '=')) {
                            cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                            break;
                        }
                    }
                }
                return cookieValue;
            }

            function csrfSafeMethod(method) {
                // these HTTP methods do not require CSRF protection
                return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
            }

            function sameOrigin(url) {
                // test that a given url is a same-origin URL
                // url could be relative or scheme relative or absolute
                var host = document.location.host; // host + port
                var protocol = document.location.protocol;
                var sr_origin = '//' + host;
                var origin = protocol + sr_origin;
                // Allow absolute or scheme relative URLs to same origin
                return (url == origin || url.slice(0, origin.length + 1) == origin + '/') ||
                    (url == sr_origin || url.slice(0, sr_origin.length + 1) == sr_origin + '/') ||
                    // or any other URL that isn't scheme relative or absolute i.e relative.
                    !(/^(\/\/|http:|https:).*/.test(url));
            }
            
            $(document).ready(function(){
                csrftoken = getCookie('csrftoken');
                $.ajaxSetup({
                        beforeSend: function(xhr, settings) {
                            if (!csrfSafeMethod(settings.type) && sameOrigin(settings.url)) {
                                xhr.setRequestHeader("X-CSRFToken", csrftoken);
                            }
                        }
                });

                $('#account').click(function(){
                    $('#account_nav').slideToggle();
                });

                $('#projects_list').click(function(){
                    $('#projects_nav').slideToggle();
                });

                $('#context').click(function(){
                    $('#context_nav').slideToggle();
                });

                $('#search').click(function(){
                    $('#search_nav').slideToggle();
                });

                //$('#account_nav').hover(function(){},function(){$('#account_nav').slideToggle();}) 

                $(document).click(function(event) { 
                    if($(event.target).index($('#account_nav')) == -1 && $(event.target).attr('id') != "account"){

                        if($('#account_nav').css('display') != "none"){
                            $('#account_nav').slideToggle(); 
                        }                
                    }

                    if($(event.target).index($('#projects_nav')) == -1 && $(event.target).attr('id') != "projects_list"){

                        if($('#projects_nav').css('display') != "none"){
                            $('#projects_nav').slideToggle(); 
                        }                
                    }

                    if($(event.target).index($('#context_nav')) == -1 && $(event.target).attr('id') != "context"){

                        if($('#context_nav').css('display') != "none"){
                            $('#context_nav').slideToggle(); 
                        }                
                    }

                    if($(event.target).index($('#search_nav')) == -1 && $(event.target).attr('id') != "search"){

                        if($('#search_nav').css('display') != "none"){
                            $('#search_nav').slideToggle(); 
                        }                
                    }
                });

            });



        </script>

        {% block extra_head %}{% endblock %}
    </head>
    <body>
        <div id="top_nav" class="both">
             <div class="left"><a href="/">[Home]</a></div>
             <div class="right"> 
                <div class="main_nav_button" id="context">Context Drop Down </div> | 
                <div class="main_nav_button" id="projects_list">Project List </div>|
                <div class="main_nav_button"><a id="account">{{user|truncatechars:15}}</a></div>
                <div class="main_nav_button"><form action="/issue/search" method="POST">{% csrf_token %}<input type="text" name="searchText" id="search"/><input type="submit" value="search"/></form></div>
            </div>
            <div id="context_nav" class="container_nav"> 
                {% block context_nav %}{% endblock %}  
            </div>
            <div id="projects_nav" class="container_nav"> 
                {% for project in projects%}
                   <a href="/project/{{project.id}}">{{project.name}}</a>
                {% endfor %}
                <a href="/project/new">New Project</a>
            </div>
            <div id="account_nav" class="container_nav">   
                <a href="/accounts/account_settings">Account Settings</a>
                <a href="/accounts/logout/?next=/">Logout</a>
            </div>
            <div id="search_nav" class="container_nav">   
                <a href="#">Advanced Search</a>
            </div>
        </div>
        <h1>{{page_type}} <span>:: </span></h1>
        <div class="both">&nbsp;</div>
        <div class="spiffy_box right">{% block spiffy_box_right %}{% endblock %}</div>
        <div class="container">
            {% block container %}{% endblock %}
            
        </div>
        <div class="container">
            {% block container_bottom_clear %}{% endblock %}
        </div>
        <p class="both"></p>
    </body>
</html>
